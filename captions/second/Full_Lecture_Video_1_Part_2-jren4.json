[{"text":"alright and keep doing this while either one of these is valid","width":624},{"text":"okay what do you think about that code?","width":370},{"text":"hold on hold on you can't see it","width":200},{"text":"is this code correct?","width":128},{"text":"does it copy the null byte at the end?","width":1104},{"text":"okay alright if your neighbor thinks it copies the null byte get a new neighbor","width":524},{"text":"right why does it not copy the null byte?","width":543},{"text":"because we've incremented the source pointer","width":215},{"text":"right so we copy a byte, we keep copying characters and then we increment the source pointer and then we say while source","width":446},{"text":"so we are checking the next byte, the byte that we haven't yet copied","width":496},{"text":"so no, that code doesn't actually coy the very last byte","width":263},{"text":"you see, C program is easy","width":226},{"text":"or actually C programming with bugs is easy, writing correct programs is harder","width":369},{"text":"and we wouldn't have spotted this if our destination memory had all been zeroed by some fortuitous accident","width":448},{"text":"so that is incomplete, we still need to copy the byte at the end","width":373},{"text":"so at the very end I need to put a null byte in","width":374},{"text":"so I could write that as zero, I could write that as backslash zero","width":421},{"text":"that means the null byte","width":115},{"text":"and then finally return dest","width":471},{"text":"okay what do you think about that code","width":273},{"text":"yes, so if source is just an empty string what would happen?","width":866},{"text":"correct, we put two null bytes at the end","width":268},{"text":"so that's dangerous right? our code would actually copy more bytes than say the standard specification","width":540},{"text":"so now we've got a bug that only happens when we copy empty strings","width":537},{"text":"what else? there's another bug as well. yes? I'm writing memory that isn't part of dest or source","width":833},{"text":"okay, so I haven't malloc'd a new buffer yeah. okay so let me first mention the error I was going to point out","width":368},{"text":"which is actually the specification of strcat says we should return the beginning of the string","width":267},{"text":"we are actually returning the end of the string","width":150},{"text":"whoops, so we probably should have kept a copy of what the original value of dest was","width":363},{"text":"as it happens, most people don't tend to use this return value","width":225},{"text":"and so your code might work in most places until the day it doesn't","width":379},{"text":"now let's get back to that question of oh we haven't malloc'd any memory","width":225},{"text":"so strcat actually assumes that the destination is big enough for all these bytes that we are going to copy","width":536},{"text":"it doesn't do any mallocing itself, it just says okay give me a pointer, I'm going to assume that there is enough bytes available for me to copy whatever is available at source","width":610},{"text":"and if that is not true, well let's hope this code isn't actually driving a car or an expensive robot or flying a plane","width":568},{"text":"or something inside your bloodstream","width":332},{"text":"so strcat is dangerous, you have to promise that you've got enough bytes allocated at the target","width":597},{"text":"and for that reason many people avoid it and use strncat instead","width":393},{"text":"which I'm not going to talk about today","width":99},{"text":"and that saves you from some of these gotchas","width":248},{"text":"so it's better but it's still not perfect","width":186},{"text":"you can still have problems with strncat but I don't have time to talk about it right now","width":491},{"text":"okay right so for your next serving of C, I've got some code down here that uses strcpy and strcat and arrays and pointers to stuff","width":687},{"text":"what errors do you spot? if this was say a code review or in an interview and they said \"hey look at this code, what can you tell me about this?\"","width":602},{"text":"what can you and your neighbor find? what errors?","width":338},{"text":"what kinds of errors and how would you explain them?","width":284},{"text":"[long pause]","width":9735}]